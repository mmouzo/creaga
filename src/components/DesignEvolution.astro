---
const evolutionSteps = [
  {
    id: 1,
    title: 'Análisis del Emplazamiento',
    subtitle: 'Estudio de Condicionantes y Ubicación',
    description: 'Análisis exhaustivo del lugar de Lusquiños en la parroquia pontevedresa de Tomeza, identificando las preexistencias, topografía y condicionantes del entorno rural.',
    keyPoints: [
      'Ubicación en el lugar de Lusquiños, siguiendo río arriba el curso del río Gafos',
      'Análisis de la estructura rural consolidada del núcleo existente',
      'Identificación de dos edificaciones en ruinas en parcelas separadas',
      'Estudio topográfico y ambiental del terreno'
    ],
    technicalAspects: [
      'Reconocimiento superficial de la zona',
      'Análisis parcelario y construcciones existentes',
      'Estudio de elementos tangibles e intangibles del lugar',
      'Evaluación de condicionantes de partida'
    ],
    year: 'Fase 1',
    status: 'completed'
  },
  {
    id: 2,
    title: 'Definición del Programa',
    subtitle: 'Investigación de Necesidades Ganaderas',
    description: 'Desarrollo del programa específico basado en la investigación sobre ganado vacuno, producción extensiva y ganadería ecológica adaptada al entorno gallego.',
    keyPoints: [
      'Investigación sobre tipos de animales y sus necesidades específicas',
      'Opción por producción extensiva vs. intensiva',
      'Ganadería ecológica ligada al suelo con tierras de pasto',
      'Utilización de razas autóctonas adaptadas al medio'
    ],
    technicalAspects: [
      'Análisis de ganado vacuno en pastoreo extensivo',
      'Criterios de bienestar animal y libertad de movimiento',
      'Aprovechamiento de recursos del entorno natural',
      'Prevención de enfermedades mediante razas adaptadas'
    ],
    year: 'Fase 2',
    status: 'completed'
  },
  {
    id: 3,
    title: 'Concepto Arquitectónico',
    subtitle: 'Integración con la Topografía',
    description: 'Desarrollo del concepto arquitectónico basado en la integración total con el entorno, buscando la conexión directa con el territorio sin alterar la escala del núcleo.',
    keyPoints: [
      'Edificio como serie de muros de hormigón armado perpendiculares a la pendiente',
      'Conexión directa con el territorio exterior',
      'Respeto a las visuales del lugar y escala del núcleo',
      'Cubierta plana que se convierte en paisaje'
    ],
    technicalAspects: [
      'Muros en sentido de la pendiente con programa entre ellos',
      'Aprovechamiento de la topografía para espacios semienterrados',
      'Muros de contención del terreno integrados',
      'Transición paisajística entre terreno y cubierta vegetal'
    ],
    year: 'Fase 3',
    status: 'completed'
  },
  {
    id: 4,
    title: 'Desarrollo Estructural',
    subtitle: 'Sistema de Pórticos y Voladizos',
    description: 'Definición del sistema estructural con pórticos de hormigón armado, muros de contención y voladizos asimétricos que permiten el funcionamiento ganadero.',
    keyPoints: [
      'Pórticos de hormigón armado con vigas de canto en voladizo',
      'Voladizos asimétricos mayores hacia el oeste',
      'Pasillo de acceso cubierto para protección del trabajador',
      'Ancho suficiente para paso de tractor y operario'
    ],
    technicalAspects: [
      'Muros de contención en la parte sur del edificio',
      'Desnivel de un metro para salvar la topografía',
      'Losa maciza de hormigón armado de altura constante',
      'Altura determinada por almacenamiento de alpacas en tres niveles'
    ],
    year: 'Fase 4',
    status: 'completed'
  },
  {
    id: 5,
    title: 'Distribución Funcional',
    subtitle: 'Organización Espacial del Programa',
    description: 'Organización del programa en dos parcelas principales con distribución específica para cada función ganadera, respetando los criterios de funcionalidad y sostenibilidad.',
    keyPoints: [
      'Parcela este: bodega con 1.449,79 m² para vinificación',
      'Granja principal: 2.989,32 m² para ganado vacuno',
      'Espacios diferenciados: cuadras, almacenes, garaje y control',
      'Cuadras individuales para aislamiento sanitario'
    ],
    technicalAspects: [
      'Almacenes de alimento en zona más cerrada',
      'Garaje para tractor integrado en la estructura',
      'Cuadras para cabras y ovejas de menores dimensiones',
      'Orientación variable de muros según topografía'
    ],
    year: 'Fase 5',
    status: 'current'
  },
  {
    id: 6,
    title: 'Sostenibilidad y Acabados',
    subtitle: 'Criterios Ecológicos y Durabilidad',
    description: 'Aplicación de criterios de sostenibilidad, funcionalidad y fácil mantenimiento en la elección de acabados, priorizando la durabilidad y la integración paisajística.',
    keyPoints: [
      'Criterios de funcionalidad y fácil mantenimiento',
      'Durabilidad y resistencia a las inclemencias',
      'Proceso sostenible basado en la tradición rural',
      'Lechos naturales de hierba seca para los animales'
    ],
    technicalAspects: [
      'Capa de 15 cm de hierba seca sobre forjado',
      'Conversión natural en estiércol para fertilización',
      'Estancias higiénicas mediante renovación periódica',
      'Cubierta vegetal para integración paisajística total'
    ],
    year: 'Fase 6',
    status: 'future'
  }
];
---

<div class="max-w-7xl mx-auto">
  <!-- Timeline Grid -->
  <div class="grid gap-4 md:gap-6">
    <!-- Responsive Grid: 1 column on mobile, 2 on tablet, 3 on desktop -->
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-6">
      {evolutionSteps.map((step, index) => {
        const nodeStyle = step.status === 'completed' 
          ? 'bg-criaga-red text-white' 
          : step.status === 'current' 
            ? 'bg-yellow-500 text-white' 
            : 'bg-gray-300 text-gray-600';
        
        return (
          <div class="relative group">
            <!-- Compact Step Card -->
            <div class="bg-white border-2 border-gray-200 rounded-lg shadow-sm group-hover:shadow-md group-hover:border-criaga-red transition-all duration-300 flex flex-col">
              <!-- Compact Header -->
              <div class="p-4 border-b border-gray-100 flex-shrink-0">
                <div class="flex items-center justify-between mb-2">
                  <!-- Smaller Step Badge -->
                  <div class={`w-8 h-8 rounded-full border-2 border-white shadow-md flex items-center justify-center text-sm font-bold ${nodeStyle}`}>
                    {step.id}
                  </div>
                  
                  <!-- Compact Phase Badge -->
                  <span class="text-xs bg-criaga-red/10 text-criaga-red px-2 py-1 rounded-full font-medium">
                    {step.year}
                  </span>
                </div>
                
                <div>
                  <h4 class="text-base md:text-lg font-bold text-gray-900 mb-1 leading-tight">{step.title}</h4>
                  <p class="text-xs md:text-sm text-criaga-red font-medium">{step.subtitle}</p>
                </div>
              </div>

              <!-- Compact Content -->
              <div class="p-4 flex flex-col">
                <!-- Complete Description -->
                <p class="text-sm text-gray-600 leading-relaxed mb-3">
                  {step.description}
                </p>

                <!-- Compact Expandable Details -->
                <details class="group/details">
                  <summary class="cursor-pointer text-criaga-red font-medium hover:text-criaga-red/80 transition-colors flex items-center justify-between w-full py-2 px-3 bg-gray-50 rounded-md text-sm">
                    <span>Detalles</span>
                    <svg class="w-4 h-4 transform transition-transform group-open/details:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width={2} d="M19 9l-7 7-7-7" />
                    </svg>
                  </summary>
                  
                  <div class="mt-2 p-3 bg-gray-50 rounded-md">
                    <div class="space-y-3">
                      <!-- Complete Key Points -->
                      <div>
                        <h5 class="font-semibold text-gray-900 mb-2 text-sm flex items-center">
                          <span class="w-1.5 h-1.5 bg-criaga-red rounded-full mr-2"></span>
                          Puntos Clave
                        </h5>
                        <ul class="space-y-1">
                          {step.keyPoints.map((point) => (
                            <li class="text-xs text-gray-600 flex items-start">
                              <span class="text-criaga-red mr-1.5 mt-0.5 flex-shrink-0">•</span>
                              <span>{point}</span>
                            </li>
                          ))}
                        </ul>
                      </div>

                      <!-- Complete Technical Aspects -->
                      <div>
                        <h5 class="font-semibold text-gray-900 mb-2 text-sm flex items-center">
                          <span class="w-1.5 h-1.5 bg-blue-500 rounded-full mr-2"></span>
                          Aspectos Técnicos
                        </h5>
                        <ul class="space-y-1">
                          {step.technicalAspects.map((aspect) => (
                            <li class="text-xs text-gray-600 flex items-start">
                              <span class="text-blue-500 mr-1.5 mt-0.5 flex-shrink-0">▸</span>
                              <span>{aspect}</span>
                            </li>
                          ))}
                        </ul>
                      </div>
                    </div>
                  </div>
                </details>
              </div>
            </div>
          </div>
        );
      })}
    </div>
  </div>

  <!-- Compact Process Flow Indicator -->
  <div class="mt-8 mb-6">
    <div class="flex justify-center">
      <div class="flex items-center space-x-2 bg-gray-50 rounded-full px-4 py-2">
        {evolutionSteps.map((step, index) => {
          const isCompleted = step.status === 'completed';
          const isCurrent = step.status === 'current';
          
          return (
            <div class="flex items-center">
              <div class={`w-2 h-2 rounded-full transition-colors ${
                isCompleted ? 'bg-criaga-red' : 
                isCurrent ? 'bg-yellow-500' : 
                'bg-gray-300'
              }`}></div>
              {index < evolutionSteps.length - 1 && (
                <div class="w-4 h-0.5 bg-gray-300 mx-1"></div>
              )}
            </div>
          );
        })}
      </div>
    </div>
  </div>

  <!-- Compact Summary Stats -->
  <div class="mt-8 pt-6 border-t border-gray-200">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4">
      <div class="bg-white p-3 md:p-4 rounded-lg border border-gray-200 hover:border-criaga-red transition-colors text-center">
        <div class="text-xl md:text-2xl font-bold text-criaga-red mb-1">{evolutionSteps.length}</div>
        <div class="text-xs md:text-sm text-gray-600 font-medium">Fases</div>
      </div>
      <div class="bg-white p-3 md:p-4 rounded-lg border border-gray-200 hover:border-criaga-red transition-colors text-center">
        <div class="text-xl md:text-2xl font-bold text-criaga-red mb-1">2</div>
        <div class="text-xs md:text-sm text-gray-600 font-medium">Parcelas</div>
      </div>
      <div class="bg-white p-3 md:p-4 rounded-lg border border-gray-200 hover:border-criaga-red transition-colors text-center">
        <div class="text-xl md:text-2xl font-bold text-criaga-red mb-1">3</div>
        <div class="text-xs md:text-sm text-gray-600 font-medium">Edificaciones</div>
      </div>
      <div class="bg-white p-3 md:p-4 rounded-lg border border-gray-200 hover:border-criaga-red transition-colors text-center">
        <div class="text-xl md:text-2xl font-bold text-criaga-red mb-1">100%</div>
        <div class="text-xs md:text-sm text-gray-600 font-medium">Integración</div>
      </div>
    </div>
  </div>
</div>
